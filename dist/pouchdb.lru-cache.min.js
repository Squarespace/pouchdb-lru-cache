!function t(e,n,r){function o(u,s){if(!n[u]){if(!e[u]){var c="function"==typeof require&&require;if(!s&&c)return c(u,!0);if(i)return i(u,!0);throw new Error("Cannot find module '"+u+"'")}var a=n[u]={exports:{}};e[u][0].call(a.exports,function(t){var n=e[u][1][t];return o(n?n:t)},a,a.exports,t,e,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(t,e,n){"use strict";function r(t,e,n){return t.get(e)["catch"](function(r){if(404!==r.status)throw r;return n._id=e,t.put(n)["catch"](function(t){if(409!==t.status)throw t}).then(function(){return t.get(e)})})}function o(t){return r(t,w,{}).then(function(t){return t._attachments||(t._attachments={}),t})}function i(t){return r(t,y,{lastUsed:{}})}function u(t){return m.all([o(t),i(t)])}function s(t){return"$"+t}function c(t){return t.substring(1)}function a(t){var e={};Object.keys(t._attachments).forEach(function(n){var r=t._attachments[n];e[r.digest]=r.length});var n=0;return Object.keys(e).forEach(function(t){n+=e[t]}),n}function f(t){return function(){var e=g.then(t);return g=e["catch"](E),e}}function l(t,e){var n={};return Object.keys(t._attachments).forEach(function(r){var o=t._attachments[r],i=n[o.digest]||0;n[o.digest]=Math.max(i,e.lastUsed[o.digest])}),n}function h(t,e){var n,r,o=l(t,e);return Object.keys(o).forEach(function(t){var e=o[t];("undefined"==typeof n||n>e)&&(n=e,r=t)}),r}function d(t,e,n,r){return o(t).then(function(o){return o._attachments[e]?void 0:t.putAttachment(w,e,o._rev,n,r)})}function p(t,e,n,r){return u(t).then(function(o){var i=o[0],u=o[1],s=i._attachments[e].digest;u.lastUsed[s]=n;var c=a(i);if(r>=c)return t.put(u);for(;c>r;){for(var f=h(i,u),l=Object.keys(i._attachments),d=0;d<l.length;d++){var p=l[d];i._attachments[p].digest===f&&delete i._attachments[p]}c=a(i)}return t.bulkDocs([u,i])})}var v=t("./pouch-utils"),m=v.Promise,w="lru__",y="_local/lru_last_used",g=m.resolve(),E=function(){};n.initLru=function(t){var e=this;("number"!=typeof t||0===t)&&(t=Number.MAX_VALUE);var n={};n.put=function(n,r,o){var i=s(n),u=Date.now();return m.resolve().then(function(){if(!o)throw new Error("need to specify a content-type")}).then(f(function(){return d(e,i,r,o)})).then(f(function(){return p(e,i,u,t)})).then(function(){return e.compact()})},n.peek=function(t){var n=s(t);return e.getAttachment(w,n)},n.del=function(t){var n=s(t);return m.resolve().then(f(function(){return o(e).then(function(t){return delete t._attachments[n],e.put(t)})}))},n.get=function(t){var n=s(t),r=Date.now();return m.resolve().then(f(function(){return u(e).then(function(t){var o=t[0],i=t[1],u=o._attachments[n];return u&&i.lastUsed[u.digest]?(i.lastUsed[u.digest]=r,e.put(i)):void 0})})).then(function(){return e.getAttachment(w,n)})},n.has=function(t){var n=s(t);return o(e).then(function(t){return!!t._attachments[n]})},n.info=function(){return m.resolve().then(function(){return u(e)}).then(function(t){var e=t[0],n=t[1],r={},o={};Object.keys(e._attachments).forEach(function(t){var i=e._attachments[t];t=c(t),r[t]={length:i.length,digest:i.digest,lastUsed:n.lastUsed[i.digest]},o[i.digest]=i.length});var i=0;Object.keys(o).forEach(function(t){i+=o[t]});var u=0;return Object.keys(n.lastUsed).forEach(function(t){t in o||u++}),{items:r,numUniqueItems:Object.keys(o).length,numEvicted:u,totalLength:i}})},e.lru=n},"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(n)},{"./pouch-utils":23}],2:[function(t,e,n){},{}],3:[function(t,e,n){var r=e.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],4:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],5:[function(t,e,n){"use strict";function r(){}e.exports=r},{}],6:[function(t,e,n){"use strict";function r(t){function e(t,e){function o(t){a[e]=t,++f===n&!r&&(r=!0,c.resolve(h,a))}u(t).then(o,function(t){r||(r=!0,c.reject(h,t))})}if("[object Array]"!==Object.prototype.toString.call(t))return i(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return u([]);for(var a=new Array(n),f=0,l=-1,h=new o(s);++l<n;)e(t[l],l);return h}var o=t("./promise"),i=t("./reject"),u=t("./resolve"),s=t("./INTERNAL"),c=t("./handlers");e.exports=r},{"./INTERNAL":5,"./handlers":7,"./promise":9,"./reject":12,"./resolve":13}],7:[function(t,e,n){"use strict";function r(t){var e=t&&t.then;return t&&"object"==typeof t&&"function"==typeof e?function(){e.apply(t,arguments)}:void 0}var o=t("./tryCatch"),i=t("./resolveThenable"),u=t("./states");n.resolve=function(t,e){var s=o(r,e);if("error"===s.status)return n.reject(t,s.value);var c=s.value;if(c)i.safely(t,c);else{t.state=u.FULFILLED,t.outcome=e;for(var a=-1,f=t.queue.length;++a<f;)t.queue[a].callFulfilled(e)}return t},n.reject=function(t,e){t.state=u.REJECTED,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t}},{"./resolveThenable":14,"./states":15,"./tryCatch":16}],8:[function(t,e,n){e.exports=n=t("./promise"),n.resolve=t("./resolve"),n.reject=t("./reject"),n.all=t("./all"),n.race=t("./race")},{"./all":6,"./promise":9,"./race":11,"./reject":12,"./resolve":13}],9:[function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=s.PENDING,this.queue=[],this.outcome=void 0,t!==i&&u.safely(this,t)}var o=t("./unwrap"),i=t("./INTERNAL"),u=t("./resolveThenable"),s=t("./states"),c=t("./queueItem");e.exports=r,r.prototype["catch"]=function(t){return this.then(null,t)},r.prototype.then=function(t,e){if("function"!=typeof t&&this.state===s.FULFILLED||"function"!=typeof e&&this.state===s.REJECTED)return this;var n=new r(i);if(this.state!==s.PENDING){var u=this.state===s.FULFILLED?t:e;o(n,u,this.outcome)}else this.queue.push(new c(n,t,e));return n}},{"./INTERNAL":5,"./queueItem":10,"./resolveThenable":14,"./states":15,"./unwrap":17}],10:[function(t,e,n){"use strict";function r(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}var o=t("./handlers"),i=t("./unwrap");e.exports=r,r.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},r.prototype.otherCallFulfilled=function(t){i(this.promise,this.onFulfilled,t)},r.prototype.callRejected=function(t){o.reject(this.promise,t)},r.prototype.otherCallRejected=function(t){i(this.promise,this.onRejected,t)}},{"./handlers":7,"./unwrap":17}],11:[function(t,e,n){"use strict";function r(t){function e(t){u(t).then(function(t){r||(r=!0,c.resolve(f,t))},function(t){r||(r=!0,c.reject(f,t))})}if("[object Array]"!==Object.prototype.toString.call(t))return i(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return u([]);for(var a=-1,f=new o(s);++a<n;)e(t[a]);return f}var o=t("./promise"),i=t("./reject"),u=t("./resolve"),s=t("./INTERNAL"),c=t("./handlers");e.exports=r},{"./INTERNAL":5,"./handlers":7,"./promise":9,"./reject":12,"./resolve":13}],12:[function(t,e,n){"use strict";function r(t){var e=new o(i);return u.reject(e,t)}var o=t("./promise"),i=t("./INTERNAL"),u=t("./handlers");e.exports=r},{"./INTERNAL":5,"./handlers":7,"./promise":9}],13:[function(t,e,n){"use strict";function r(t){if(t)return t instanceof o?t:u.resolve(new o(i),t);var e=typeof t;switch(e){case"boolean":return s;case"undefined":return a;case"object":return c;case"number":return f;case"string":return l}}var o=t("./promise"),i=t("./INTERNAL"),u=t("./handlers");e.exports=r;var s=u.resolve(new o(i),!1),c=u.resolve(new o(i),null),a=u.resolve(new o(i),void 0),f=u.resolve(new o(i),0),l=u.resolve(new o(i),"")},{"./INTERNAL":5,"./handlers":7,"./promise":9}],14:[function(t,e,n){"use strict";function r(t,e){function n(e){s||(s=!0,o.reject(t,e))}function r(e){s||(s=!0,o.resolve(t,e))}function u(){e(r,n)}var s=!1,c=i(u);"error"===c.status&&n(c.value)}var o=t("./handlers"),i=t("./tryCatch");n.safely=r},{"./handlers":7,"./tryCatch":16}],15:[function(t,e,n){n.REJECTED=["REJECTED"],n.FULFILLED=["FULFILLED"],n.PENDING=["PENDING"]},{}],16:[function(t,e,n){"use strict";function r(t,e){var n={};try{n.value=t(e),n.status="success"}catch(r){n.status="error",n.value=r}return n}e.exports=r},{}],17:[function(t,e,n){"use strict";function r(t,e,n){o(function(){var r;try{r=e(n)}catch(o){return i.reject(t,o)}r===t?i.reject(t,new TypeError("Cannot resolve promise with itself")):i.resolve(t,r)})}var o=t("immediate"),i=t("./handlers");e.exports=r},{"./handlers":7,immediate:18}],18:[function(t,e,n){"use strict";function r(){u=!1,s&&s.length?l=s.concat(l):f=-1,l.length&&o()}function o(){u=!0;for(var t=l.length,e=setTimeout(r);t;){for(s=l,l=[];++f<t;)s[f]();f=-1,t=l.length}f=-1,u=!1,clearTimeout(e)}function i(t){1!==l.push(t)||u||c()}for(var u,s,c,a=[t("./nextTick"),t("./mutation.js"),t("./messageChannel"),t("./stateChange"),t("./timeout")],f=-1,l=[],h=-1,d=a.length;++h<d;)if(a[h]&&a[h].test&&a[h].test()){c=a[h].install(o);break}e.exports=i},{"./messageChannel":19,"./mutation.js":20,"./nextTick":2,"./stateChange":21,"./timeout":22}],19:[function(t,e,n){var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};n.test=function(){return r.setImmediate?!1:"undefined"!=typeof r.MessageChannel},n.install=function(t){var e=new r.MessageChannel;return e.port1.onmessage=t,function(){e.port2.postMessage(0)}}},{}],20:[function(t,e,n){var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},o=r.MutationObserver||r.WebKitMutationObserver;n.test=function(){return o},n.install=function(t){var e=0,n=new o(t),i=r.document.createTextNode("");return n.observe(i,{characterData:!0}),function(){i.data=e=++e%2}}},{}],21:[function(t,e,n){var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};n.test=function(){return"document"in r&&"onreadystatechange"in r.document.createElement("script")},n.install=function(t){return function(){var e=r.document.createElement("script");return e.onreadystatechange=function(){t(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},r.document.documentElement.appendChild(e),t}}},{}],22:[function(t,e,n){"use strict";n.test=function(){return!0},n.install=function(t){return function(){setTimeout(t,0)}}},{}],23:[function(t,e,n){var r,o=t("__browserify_process"),i="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};r="undefined"!=typeof window&&window.PouchDB?window.PouchDB.utils.Promise:"function"==typeof i.Promise?i.Promise:t("lie"),n.once=function(t){var e=!1;return n.getArguments(function(n){if(e)throw console.trace(),new Error("once called  more than once");e=!0,t.apply(this,n)})},n.getArguments=function(t){return function(){for(var e=arguments.length,n=new Array(e),r=-1;++r<e;)n[r]=arguments[r];return t.call(this,n)}},n.toPromise=function(t){return n.getArguments(function(e){var i,u=this,s="function"==typeof e[e.length-1]?e.pop():!1;s&&(i=function(t,e){o.nextTick(function(){s(t,e)})});var c=new r(function(r,o){try{var i=n.once(function(t,e){t?o(t):r(e)});e.push(i),t.apply(u,e)}catch(s){o(s)}});return i&&c.then(function(t){i(null,t)},i),c.cancel=function(){return this},c})},n.inherits=t("inherits"),n.Promise=r},{__browserify_process:3,inherits:4,lie:8}]},{},[1]);
